{"version":3,"file":"index.esm.js","sources":["../node_modules/tslib/tslib.es6.js","../src/VisionScanner.tsx"],"sourcesContent":["/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\r\n    function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\r\n    var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\r\n    var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\r\n    var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\r\n    var _, done = false;\r\n    for (var i = decorators.length - 1; i >= 0; i--) {\r\n        var context = {};\r\n        for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\r\n        for (var p in contextIn.access) context.access[p] = contextIn.access[p];\r\n        context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\r\n        var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\r\n        if (kind === \"accessor\") {\r\n            if (result === void 0) continue;\r\n            if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\r\n            if (_ = accept(result.get)) descriptor.get = _;\r\n            if (_ = accept(result.set)) descriptor.set = _;\r\n            if (_ = accept(result.init)) initializers.unshift(_);\r\n        }\r\n        else if (_ = accept(result)) {\r\n            if (kind === \"field\") initializers.unshift(_);\r\n            else descriptor[key] = _;\r\n        }\r\n    }\r\n    if (target) Object.defineProperty(target, contextIn.name, descriptor);\r\n    done = true;\r\n};\r\n\r\nexport function __runInitializers(thisArg, initializers, value) {\r\n    var useValue = arguments.length > 2;\r\n    for (var i = 0; i < initializers.length; i++) {\r\n        value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\r\n    }\r\n    return useValue ? value : void 0;\r\n};\r\n\r\nexport function __propKey(x) {\r\n    return typeof x === \"symbol\" ? x : \"\".concat(x);\r\n};\r\n\r\nexport function __setFunctionName(f, name, prefix) {\r\n    if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\r\n    return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\r\n};\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\r\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\r\n    function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nvar ownKeys = function(o) {\r\n    ownKeys = Object.getOwnPropertyNames || function (o) {\r\n        var ar = [];\r\n        for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\r\n        return ar;\r\n    };\r\n    return ownKeys(o);\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n\r\nexport function __addDisposableResource(env, value, async) {\r\n    if (value !== null && value !== void 0) {\r\n        if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\r\n        var dispose, inner;\r\n        if (async) {\r\n            if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\r\n            dispose = value[Symbol.asyncDispose];\r\n        }\r\n        if (dispose === void 0) {\r\n            if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\r\n            dispose = value[Symbol.dispose];\r\n            if (async) inner = dispose;\r\n        }\r\n        if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\r\n        if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\r\n        env.stack.push({ value: value, dispose: dispose, async: async });\r\n    }\r\n    else if (async) {\r\n        env.stack.push({ async: true });\r\n    }\r\n    return value;\r\n\r\n}\r\n\r\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\r\n    var e = new Error(message);\r\n    return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\r\n};\r\n\r\nexport function __disposeResources(env) {\r\n    function fail(e) {\r\n        env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\r\n        env.hasError = true;\r\n    }\r\n    var r, s = 0;\r\n    function next() {\r\n        while (r = env.stack.pop()) {\r\n            try {\r\n                if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\r\n                if (r.dispose) {\r\n                    var result = r.dispose.call(r.value);\r\n                    if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\r\n                }\r\n                else s |= 1;\r\n            }\r\n            catch (e) {\r\n                fail(e);\r\n            }\r\n        }\r\n        if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\r\n        if (env.hasError) throw env.error;\r\n    }\r\n    return next();\r\n}\r\n\r\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\r\n    if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\r\n        return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\r\n            return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\r\n        });\r\n    }\r\n    return path;\r\n}\r\n\r\nexport default {\r\n    __extends: __extends,\r\n    __assign: __assign,\r\n    __rest: __rest,\r\n    __decorate: __decorate,\r\n    __param: __param,\r\n    __esDecorate: __esDecorate,\r\n    __runInitializers: __runInitializers,\r\n    __propKey: __propKey,\r\n    __setFunctionName: __setFunctionName,\r\n    __metadata: __metadata,\r\n    __awaiter: __awaiter,\r\n    __generator: __generator,\r\n    __createBinding: __createBinding,\r\n    __exportStar: __exportStar,\r\n    __values: __values,\r\n    __read: __read,\r\n    __spread: __spread,\r\n    __spreadArrays: __spreadArrays,\r\n    __spreadArray: __spreadArray,\r\n    __await: __await,\r\n    __asyncGenerator: __asyncGenerator,\r\n    __asyncDelegator: __asyncDelegator,\r\n    __asyncValues: __asyncValues,\r\n    __makeTemplateObject: __makeTemplateObject,\r\n    __importStar: __importStar,\r\n    __importDefault: __importDefault,\r\n    __classPrivateFieldGet: __classPrivateFieldGet,\r\n    __classPrivateFieldSet: __classPrivateFieldSet,\r\n    __classPrivateFieldIn: __classPrivateFieldIn,\r\n    __addDisposableResource: __addDisposableResource,\r\n    __disposeResources: __disposeResources,\r\n    __rewriteRelativeImportExtension: __rewriteRelativeImportExtension,\r\n};\r\n","\"use client\";\n\nimport { useRef, useEffect, useState, useCallback } from \"react\";\nimport { VisionScannerProps } from \"./types\";\nimport \"./styles.css\";\n\nexport const VisionScanner = ({\n  onCapture,\n  facingMode = \"environment\",\n  onError,\n  resolution = { width: 640, height: 480 },\n}: VisionScannerProps) => {\n  // Refs - stable references that don't cause re-renders\n  const videoRef = useRef<HTMLVideoElement>(null);\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const edgeCanvasRef = useRef<HTMLCanvasElement>(null);\n  const cvRef = useRef<any>(null);\n  const animationFrameRef = useRef<number | null>(null);\n  const streamRef = useRef<MediaStream | null>(null);\n  const processingRef = useRef<boolean>(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  \n  // State that affects UI rendering\n  const [isCameraReady, setIsCameraReady] = useState(false);\n  const [cameraCount, setCameraCount] = useState(0);\n  const [currentFacingMode, setCurrentFacingMode] = useState(facingMode);\n  const [hasTorch, setHasTorch] = useState(false);\n  const [torchOn, setTorchOn] = useState(false);\n  const [isOpenCVReady, setIsOpenCVReady] = useState(false);\n  const [isEdgeDetectionActive, setIsEdgeDetectionActive] = useState(true); // Enabled by default\n  const [isLoading, setIsLoading] = useState(true);\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const [documentCorners, setDocumentCorners] = useState<{ x: number, y: number }[] | null>(null);\n\n  // Internal function to stop stream - doesn't trigger re-renders\n  const stopStreamInternal = useCallback(() => {\n    if (animationFrameRef.current) {\n      cancelAnimationFrame(animationFrameRef.current);\n      animationFrameRef.current = null;\n    }\n    \n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n    }\n  }, []);\n\n  // Load OpenCV.js only once on mount\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    // Handle already loaded OpenCV\n    // @ts-ignore\n    if (window.cv) {\n      // @ts-ignore\n      cvRef.current = window.cv;\n      setIsOpenCVReady(true);\n      console.log(\"OpenCV already loaded\");\n      return;\n    }\n    \n    // Add script only if it doesn't exist\n    if (!document.getElementById('opencv-script')) {\n      const script = document.createElement('script');\n      script.id = 'opencv-script';\n      script.src = 'https://docs.opencv.org/4.7.0/opencv.js';\n      script.async = true;\n      \n      script.onload = () => {\n        console.log(\"OpenCV.js script loaded, waiting for initialization...\");\n        // Start polling for cv object\n        const checkInterval = setInterval(() => {\n          // @ts-ignore\n          if (window.cv) {\n            clearInterval(checkInterval);\n            // @ts-ignore\n            cvRef.current = window.cv;\n            setIsOpenCVReady(true);\n            console.log(\"OpenCV.js initialized through polling\");\n          }\n        }, 200);\n        \n        // Set a timeout to prevent infinite polling\n        setTimeout(() => clearInterval(checkInterval), 20000);\n      };\n      \n      script.onerror = (e) => {\n        console.error(\"Failed to load OpenCV.js\", e);\n        onError?.(\"Failed to load computer vision library\");\n      };\n      \n      document.body.appendChild(script);\n    }\n    \n    // Add fullscreen event listeners for all browser variants\n    const handleFullscreenChange = () => {\n      setIsFullscreen(\n        !!document.fullscreenElement || \n        // @ts-ignore - Webkit\n        !!document.webkitFullscreenElement ||\n        // @ts-ignore - Mozilla\n        !!document.mozFullScreenElement ||\n        // @ts-ignore - MS\n        !!document.msFullscreenElement\n      );\n    };\n    \n    document.addEventListener('fullscreenchange', handleFullscreenChange);\n    document.addEventListener('webkitfullscreenchange', handleFullscreenChange);\n    document.addEventListener('mozfullscreenchange', handleFullscreenChange);\n    document.addEventListener('MSFullscreenChange', handleFullscreenChange);\n    \n    // Check if user is on mobile\n    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\n    if (isMobile) {\n      // On mobile, start in full height mode by default\n      setIsFullscreen(true);\n    }\n    \n    // Cleanup function\n    return () => {\n      stopStreamInternal();\n      document.removeEventListener('fullscreenchange', handleFullscreenChange);\n      document.removeEventListener('webkitfullscreenchange', handleFullscreenChange);\n      document.removeEventListener('mozfullscreenchange', handleFullscreenChange);\n      document.removeEventListener('MSFullscreenChange', handleFullscreenChange);\n    };\n  }, [onError, stopStreamInternal]);\n\n  // Camera management functions\n  const stopStream = useCallback(() => {\n    stopStreamInternal();\n    setIsCameraReady(false);\n  }, [stopStreamInternal]);\n\n  const enumerateCameras = useCallback(async () => {\n    if (typeof window === 'undefined' || !navigator.mediaDevices?.enumerateDevices) {\n      onError?.(\"Camera access not supported in this browser\");\n      setCameraCount(0);\n      return;\n    }\n    \n    try {\n      const devices = await navigator.mediaDevices.enumerateDevices();\n      const videoDevices = devices.filter(device => device.kind === \"videoinput\");\n      setCameraCount(videoDevices.length);\n    } catch (err: any) {\n      onError?.(`Failed to detect cameras: ${err.message}`);\n      setCameraCount(0);\n      console.error(\"Camera enumeration error:\", err);\n    }\n  }, [onError]);\n\n  const initCamera = useCallback(async () => {\n    if (typeof window === 'undefined') return;\n    \n    if (!navigator.mediaDevices?.getUserMedia) {\n      onError?.(\"Camera not supported in this browser\");\n      setIsLoading(false);\n      return;\n    }\n    \n    try {\n      setIsLoading(true);\n      \n      // Stop any existing stream first\n      stopStreamInternal();\n      \n      // Try to get higher resolution for better document detection\n      const constraints = {\n        video: {\n          facingMode: currentFacingMode,\n          width: { ideal: 1920 },\n          height: { ideal: 1080 },\n          // Prioritize quality over framerate for document scanning\n          frameRate: { ideal: 30 },\n        },\n      };\n      \n      const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      \n      // Store stream in ref to avoid re-renders\n      streamRef.current = newStream;\n      \n      if (videoRef.current) {\n        videoRef.current.srcObject = newStream;\n        \n        // Use promise-based approach for onloadedmetadata\n        const playVideo = async () => {\n          try {\n            if (videoRef.current) {\n              await videoRef.current.play();\n              setIsCameraReady(true);\n              setIsLoading(false);\n              \n              // Check for torch capability\n              const track = newStream.getVideoTracks()[0];\n              const capabilities = track.getCapabilities();\n              setHasTorch(capabilities && \"torch\" in capabilities);\n              \n              // Enumerate cameras after successful initialization\n              enumerateCameras();\n            }\n          } catch (err: any) {\n            onError?.(`Video playback failed: ${err.message}`);\n            console.error(\"Video playback error:\", err);\n            setIsLoading(false);\n          }\n        };\n        \n        videoRef.current.onloadedmetadata = () => {\n          playVideo();\n        };\n      }\n    } catch (err: any) {\n      onError?.(`Camera access error: ${err.message}`);\n      console.error(\"Camera initialization error:\", err);\n      setIsLoading(false);\n    }\n  }, [currentFacingMode, enumerateCameras, onError, stopStreamInternal]);\n\n  // Helper function to calculate rectangularity score\n  const calculateRectangularity = (corners: { x: number, y: number }[]): number => {\n    if (corners.length !== 4) return 0;\n    \n    // Calculate sides\n    const sides = [];\n    for (let i = 0; i < 4; i++) {\n      const p1 = corners[i];\n      const p2 = corners[(i + 1) % 4];\n      const dx = p2.x - p1.x;\n      const dy = p2.y - p1.y;\n      sides.push(Math.sqrt(dx * dx + dy * dy));\n    }\n    \n    // Sort sides into pairs (should be 2 pairs of equal lengths for a rectangle)\n    sides.sort((a, b) => a - b);\n    \n    // Check if sides[0] ≈ sides[1] and sides[2] ≈ sides[3]\n    const ratio1 = Math.min(sides[0], sides[1]) / Math.max(sides[0], sides[1]);\n    const ratio2 = Math.min(sides[2], sides[3]) / Math.max(sides[2], sides[3]);\n    \n    // Check if the aspect ratio is reasonable (not too narrow)\n    const aspectRatio = Math.min(sides[0] / sides[2], sides[2] / sides[0]);\n    \n    // Score based on how rectangular the shape is (all sides paired, reasonable aspect ratio)\n    return (ratio1 * ratio2) * Math.min(1, aspectRatio * 2);\n  };\n\n  // Document detection function using OpenCV - improved version\n  const detectDocumentCorners = (src: any, cv: any, width: number, height: number): { x: number, y: number }[] | null => {\n    try {\n      // Create matrices for processing\n      const gray = new cv.Mat();\n      const blurred = new cv.Mat();\n      const edges = new cv.Mat();\n      const dilated = new cv.Mat();\n      const contours = new cv.MatVector();\n      const hierarchy = new cv.Mat();\n      const dst = new cv.Mat();\n\n      // Pre-process the image - more robust preprocessing\n      cv.cvtColor(src, gray, cv.COLOR_RGBA2GRAY);\n      \n      // Apply bilateral filter for better edge preservation while removing noise\n      cv.bilateralFilter(gray, blurred, 9, 75, 75);\n      \n      // Use adaptive threshold for better results in varying lighting\n      cv.adaptiveThreshold(blurred, dst, 255, cv.ADAPTIVE_THRESH_GAUSSIAN_C, cv.THRESH_BINARY, 11, 2);\n      \n      // Apply Canny edge detection with better parameters\n      cv.Canny(blurred, edges, 50, 150, 3, true); // Use L2gradient for better accuracy\n      \n      // Dilate edges to connect broken lines\n      const dilationSize = new cv.Size(2, 2);\n      const dilationElement = cv.getStructuringElement(cv.MORPH_RECT, dilationSize);\n      cv.dilate(edges, dilated, dilationElement, new cv.Point(-1, -1), 1);\n      dilationElement.delete();\n      \n      // Find contours on the dilated edge image\n      cv.findContours(dilated, contours, hierarchy, cv.RETR_LIST, cv.CHAIN_APPROX_SIMPLE);\n      \n      // Filter contours by area, angle, and other properties\n      let bestCorners = null;\n      let maxScore = 0;\n      \n      for (let i = 0; i < contours.size(); i++) {\n        const contour = contours.get(i);\n        const area = cv.contourArea(contour);\n        const frameArea = width * height;\n        \n        // Skip tiny or huge contours\n        if (area < frameArea * 0.03 || area > frameArea * 0.98) {\n          continue;\n        }\n        \n        // Calculate contour perimeter (arc length)\n        const perimeter = cv.arcLength(contour, true);\n        \n        // Calculate contour complexity score (area / perimeter ratio)\n        // Documents tend to have a certain ratio\n        const complexity = area / (perimeter * perimeter);\n        \n        // Documents should be somewhat convex\n        const hull = new cv.Mat();\n        cv.convexHull(contour, hull);\n        const hullArea = cv.contourArea(hull);\n        const solidity = area / hullArea;\n        hull.delete();\n        \n        // Rectangle approximation\n        const epsilon = 0.02 * perimeter;\n        const approx = new cv.Mat();\n        cv.approxPolyDP(contour, approx, epsilon, true);\n        \n        // Check if approximation has 4 points (rectangular)\n        if (approx.rows === 4) {\n          // Convert to corner points\n          const corners = [];\n          for (let j = 0; j < 4; j++) {\n            corners.push({\n              x: approx.data32S[j * 2],\n              y: approx.data32S[j * 2 + 1]\n            });\n          }\n          \n          // Check if the corners form a convex quadrilateral\n          const isConvex = cv.isContourConvex(approx);\n          \n          // Calculate the angles between adjacent sides\n          let minAngle = 180;\n          let maxAngle = 0;\n          \n          for (let j = 0; j < 4; j++) {\n            const p1 = corners[j];\n            const p2 = corners[(j + 1) % 4];\n            const p3 = corners[(j + 2) % 4];\n            \n            // Calculate angle using dot product\n            const v1x = p2.x - p1.x;\n            const v1y = p2.y - p1.y;\n            const v2x = p3.x - p2.x;\n            const v2y = p3.y - p2.y;\n            \n            const dotProduct = v1x * v2x + v1y * v2y;\n            const mag1 = Math.sqrt(v1x * v1x + v1y * v1y);\n            const mag2 = Math.sqrt(v2x * v2x + v2y * v2y);\n            \n            const angle = Math.acos(dotProduct / (mag1 * mag2)) * (180 / Math.PI);\n            \n            minAngle = Math.min(minAngle, angle);\n            maxAngle = Math.max(maxAngle, angle);\n          }\n          \n          // Calculate aspect score\n          const aspectScore = calculateRectangularity(corners);\n          \n          // Calculate total score based on multiple features\n          // Higher score for shapes that are:\n          // 1. Convex\n          // 2. Have angles close to 90°\n          // 3. Have good aspect ratio\n          // 4. Have good solidity\n          const angleScore = (minAngle > 65 && maxAngle < 115) ? (1 - Math.abs(minAngle - 90) / 90) : 0;\n          const solidityScore = solidity > 0.8 ? solidity : 0;\n          \n          const totalScore = (\n            (isConvex ? 1 : 0) * 0.3 +\n            angleScore * 0.3 +\n            aspectScore * 0.2 +\n            solidityScore * 0.2\n          ) * area;  // Weight by area to prefer larger contours\n          \n          if (totalScore > maxScore) {\n            maxScore = totalScore;\n            \n            // Sort corners in order: top-left, top-right, bottom-right, bottom-left\n            corners.sort((a, b) => a.y + a.x - (b.y + b.x)); // Top-left first\n            const tl = corners[0];\n            const br = corners[corners.length - 1];\n            \n            // Top-right has smallest difference between y and x\n            // Bottom-left has largest difference between y and x\n            corners.sort((a, b) => (a.y - a.x) - (b.y - b.x));\n            const tr = corners[0];\n            const bl = corners[corners.length - 1];\n            \n            bestCorners = [tl, tr, br, bl];\n          }\n        }\n        \n        approx.delete();\n      }\n      \n      // Clean up\n      gray.delete();\n      blurred.delete();\n      edges.delete();\n      dilated.delete();\n      dst.delete();\n      contours.delete();\n      hierarchy.delete();\n      \n      return bestCorners;\n    } catch (err) {\n      console.error(\"Document detection error:\", err);\n    }\n    \n    return null;\n  };\n\n  // Edge detection and document finding function\n  const processFrame = useCallback(() => {\n    if (!videoRef.current || !edgeCanvasRef.current || !cvRef.current || !isCameraReady || !isOpenCVReady) {\n      if (isEdgeDetectionActive) {\n        animationFrameRef.current = requestAnimationFrame(processFrame);\n      }\n      return;\n    }\n    \n    // Prevent concurrent processing using ref instead of state\n    if (processingRef.current) {\n      if (isEdgeDetectionActive) {\n        animationFrameRef.current = requestAnimationFrame(processFrame);\n      }\n      return;\n    }\n    \n    processingRef.current = true;\n    \n    const cv = cvRef.current;\n    const video = videoRef.current;\n    const edgeCanvas = edgeCanvasRef.current;\n    \n    try {\n      // Set canvas size to match video exactly\n      const width = video.videoWidth || resolution.width;\n      const height = video.videoHeight || resolution.height;\n      \n      // Only resize if needed to avoid unnecessary reflows\n      if (edgeCanvas.width !== width || edgeCanvas.height !== height) {\n        edgeCanvas.width = width;\n        edgeCanvas.height = height;\n      }\n      \n      // Get the canvas context and draw the current video frame\n      const ctx = edgeCanvas.getContext('2d');\n      if (!ctx) {\n        throw new Error(\"Could not get canvas context\");\n      }\n      \n      // Clear previous drawings\n      ctx.clearRect(0, 0, width, height);\n      \n      // Create a temporary canvas to get the image data\n      const tempCanvas = document.createElement('canvas');\n      tempCanvas.width = width;\n      tempCanvas.height = height;\n      const tempCtx = tempCanvas.getContext('2d');\n      \n      if (!tempCtx) {\n        throw new Error(\"Could not get temporary canvas context\");\n      }\n      \n      // Draw the current video frame to the temp canvas\n      tempCtx.drawImage(video, 0, 0, width, height);\n      \n      // Get the image data from the canvas\n      const imageData = tempCtx.getImageData(0, 0, width, height);\n      \n      // Create OpenCV matrix from the image data\n      const src = cv.matFromImageData(imageData);\n      \n      // Detect document corners\n      const corners = detectDocumentCorners(src, cv, width, height);\n      \n      // If corners were found, draw overlay\n      if (corners && corners.length === 4) {\n        // Draw semi-transparent yellow quad\n        ctx.beginPath();\n        ctx.moveTo(corners[0].x, corners[0].y);\n        ctx.lineTo(corners[1].x, corners[1].y);\n        ctx.lineTo(corners[2].x, corners[2].y);\n        ctx.lineTo(corners[3].x, corners[3].y);\n        ctx.closePath();\n        ctx.fillStyle = 'rgba(255, 255, 0, 0.25)';\n        ctx.fill();\n        \n        // Draw solid yellow border\n        ctx.beginPath();\n        ctx.moveTo(corners[0].x, corners[0].y);\n        ctx.lineTo(corners[1].x, corners[1].y);\n        ctx.lineTo(corners[2].x, corners[2].y);\n        ctx.lineTo(corners[3].x, corners[3].y);\n        ctx.closePath();\n        ctx.strokeStyle = '#FFCC00';\n        ctx.lineWidth = 3;\n        ctx.stroke();\n        \n        // Draw corner dots\n        ctx.fillStyle = '#FFCC00';\n        corners.forEach(corner => {\n          ctx.beginPath();\n          ctx.arc(corner.x, corner.y, 6, 0, 2 * Math.PI);\n          ctx.fill();\n        });\n        \n        // Store corners for capture\n        setDocumentCorners(corners);\n      } else {\n        setDocumentCorners(null);\n      }\n      \n      // Clean up\n      src.delete();\n    } catch (err) {\n      console.error(\"Edge detection error:\", err);\n      // Clear the canvas on error to prevent showing garbage\n      const ctx = edgeCanvas.getContext('2d');\n      if (ctx) {\n        ctx.clearRect(0, 0, edgeCanvas.width, edgeCanvas.height);\n      }\n    } finally {\n      processingRef.current = false;\n      \n      // Continue processing if edge detection is active\n      if (isEdgeDetectionActive) {\n        animationFrameRef.current = requestAnimationFrame(processFrame);\n      }\n    }\n  }, [isEdgeDetectionActive, isCameraReady, isOpenCVReady, resolution.height, resolution.width]);\n\n  // Initialize camera when component mounts or facingMode changes\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      initCamera();\n    }\n    \n    return () => {\n      stopStreamInternal();\n    };\n  }, [currentFacingMode, initCamera, stopStreamInternal]);\n\n  // Handle edge detection toggle - more efficient with fewer state dependencies\n  useEffect(() => {\n    // Start or stop edge detection based on isEdgeDetectionActive state\n    if (isEdgeDetectionActive) {\n      if (!animationFrameRef.current && isOpenCVReady) {\n        console.log(\"Starting document detection\");\n        animationFrameRef.current = requestAnimationFrame(processFrame);\n      }\n    } else {\n      if (animationFrameRef.current) {\n        console.log(\"Stopping document detection\");\n        cancelAnimationFrame(animationFrameRef.current);\n        animationFrameRef.current = null;\n        \n        // Clear edge canvas when deactivated\n        if (edgeCanvasRef.current) {\n          const ctx = edgeCanvasRef.current.getContext('2d');\n          if (ctx) {\n            ctx.clearRect(0, 0, edgeCanvasRef.current.width, edgeCanvasRef.current.height);\n          }\n        }\n        \n        // Clear corners\n        setDocumentCorners(null);\n      }\n    }\n    \n    // Cleanup function\n    return () => {\n      if (animationFrameRef.current) {\n        cancelAnimationFrame(animationFrameRef.current);\n        animationFrameRef.current = null;\n      }\n    };\n  }, [isEdgeDetectionActive, isOpenCVReady, processFrame]);\n\n  // UI interaction handlers\n  const switchCamera = useCallback(() => {\n    stopStream();\n    setCurrentFacingMode(prev => (prev === \"environment\" ? \"user\" : \"environment\"));\n  }, [stopStream]);\n\n  const toggleTorch = useCallback(() => {\n    if (hasTorch && streamRef.current) {\n      const track = streamRef.current.getVideoTracks()[0];\n      const newTorchState = !torchOn;\n      track\n        .applyConstraints({ advanced: [{ torch: newTorchState }] as any })\n        .then(() => setTorchOn(newTorchState))\n        .catch(err => onError?.(`Torch toggle failed: ${err.message}`));\n    }\n  }, [hasTorch, onError, torchOn]);\n\n  const toggleEdgeDetection = useCallback(() => {\n    console.log(\"Toggle document detection:\", !isEdgeDetectionActive, \"OpenCV ready:\", isOpenCVReady);\n    setIsEdgeDetectionActive(prev => !prev);\n  }, [isEdgeDetectionActive, isOpenCVReady]);\n\n  const toggleFullscreen = useCallback(() => {\n    // Try standard fullscreen API first\n    if (!document.fullscreenElement && containerRef.current) {\n      try {\n        containerRef.current.requestFullscreen().catch((err) => {\n          console.warn(`Standard fullscreen failed: ${err.message}`);\n          // If standard fullscreen fails, just set a class for CSS to handle\n          setIsFullscreen(true);\n        });\n      } catch (err) {\n        console.warn(\"Fullscreen API not supported, using CSS fallback\");\n        setIsFullscreen(true);\n      }\n    } else if (document.exitFullscreen) {\n      try {\n        document.exitFullscreen().catch(() => {\n          // If exit fails, manually toggle the state\n          setIsFullscreen(false);\n        });\n      } catch (err) {\n        console.warn(\"Exit fullscreen API failed, using CSS fallback\");\n        setIsFullscreen(false);\n      }\n    } else {\n      // Toggle fullscreen state manually for CSS fallback\n      setIsFullscreen(prev => !prev);\n    }\n  }, []);\n\n  // Enhanced capture function that uses the detected document corners if available\n  const capture = useCallback(() => {\n    if (!isCameraReady || !videoRef.current || !canvasRef.current) {\n      onError?.(\"Camera not ready for capture\");\n      return;\n    }\n\n    // Visual feedback for capture - flash animation\n    if (edgeCanvasRef.current) {\n      const flashCtx = edgeCanvasRef.current.getContext('2d');\n      if (flashCtx) {\n        // Create flash effect\n        flashCtx.fillStyle = 'rgba(255, 255, 255, 0.5)';\n        flashCtx.fillRect(0, 0, edgeCanvasRef.current.width, edgeCanvasRef.current.height);\n        \n        // Clear the flash after a short delay\n        setTimeout(() => {\n          if (edgeCanvasRef.current && flashCtx) {\n            flashCtx.clearRect(0, 0, edgeCanvasRef.current.width, edgeCanvasRef.current.height);\n            // Redraw document overlay if needed\n            if (isEdgeDetectionActive) {\n              processFrame();\n            }\n          }\n        }, 300);\n      }\n    }\n\n    const video = videoRef.current;\n    const canvas = canvasRef.current;\n    \n    // Set canvas dimensions to match video\n    canvas.width = video.videoWidth || resolution.width;\n    canvas.height = video.videoHeight || resolution.height;\n\n    const context = canvas.getContext(\"2d\");\n    if (!context) {\n      onError?.(\"Failed to get canvas context\");\n      return;\n    }\n\n    // Capture current frame\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n    \n    // If we have document corners and OpenCV is ready, create a perspective corrected version\n    if (documentCorners && documentCorners.length === 4 && isOpenCVReady && cvRef.current) {\n      try {\n        const cv = cvRef.current;\n        \n        // Create source matrix from canvas\n        const imgData = context.getImageData(0, 0, canvas.width, canvas.height);\n        const src = cv.matFromImageData(imgData);\n        \n        // Source points (document corners detected in the image)\n        const srcPoints = cv.matFromArray(4, 1, cv.CV_32FC2, [\n          documentCorners[0].x, documentCorners[0].y, // Top-left\n          documentCorners[1].x, documentCorners[1].y, // Top-right\n          documentCorners[2].x, documentCorners[2].y, // Bottom-right\n          documentCorners[3].x, documentCorners[3].y  // Bottom-left\n        ]);\n        \n        // Calculate width and height of output document\n        const widthA = Math.sqrt(Math.pow(documentCorners[2].x - documentCorners[3].x, 2) + \n                               Math.pow(documentCorners[2].y - documentCorners[3].y, 2));\n        const widthB = Math.sqrt(Math.pow(documentCorners[1].x - documentCorners[0].x, 2) + \n                               Math.pow(documentCorners[1].y - documentCorners[0].y, 2));\n        const maxWidth = Math.max(Math.floor(widthA), Math.floor(widthB));\n        \n        const heightA = Math.sqrt(Math.pow(documentCorners[1].x - documentCorners[2].x, 2) + \n                                Math.pow(documentCorners[1].y - documentCorners[2].y, 2));\n        const heightB = Math.sqrt(Math.pow(documentCorners[0].x - documentCorners[3].x, 2) + \n                                Math.pow(documentCorners[0].y - documentCorners[3].y, 2));\n        const maxHeight = Math.max(Math.floor(heightA), Math.floor(heightB));\n        \n        // Destination points (rectangle)\n        const dstPoints = cv.matFromArray(4, 1, cv.CV_32FC2, [\n          0, 0,               // Top-left\n          maxWidth - 1, 0,    // Top-right\n          maxWidth - 1, maxHeight - 1, // Bottom-right\n          0, maxHeight - 1    // Bottom-left\n        ]);\n        \n        // Get perspective transform and apply it\n        const M = cv.getPerspectiveTransform(srcPoints, dstPoints);\n        const dst = new cv.Mat();\n        cv.warpPerspective(src, dst, M, new cv.Size(maxWidth, maxHeight));\n        \n        // Display result on canvas\n        const correctedCanvas = document.createElement('canvas');\n        correctedCanvas.width = maxWidth;\n        correctedCanvas.height = maxHeight;\n        cv.imshow(correctedCanvas, dst);\n        \n        // Get image data from the corrected canvas\n        const imageData = correctedCanvas.toDataURL(\"image/jpeg\", 0.95);\n        \n        // Clean up\n        src.delete();\n        dst.delete();\n        srcPoints.delete();\n        dstPoints.delete();\n        M.delete();\n        \n        // Pass the corrected image to parent component\n        onCapture(imageData);\n        return;\n      } catch (err) {\n        console.error(\"Error during perspective correction:\", err);\n        // Fall back to uncorrected image\n      }\n    }\n    \n    // If perspective correction failed or wasn't attempted, use the original image\n    const imageData = canvas.toDataURL(\"image/jpeg\", 0.92);\n    onCapture(imageData);\n  }, [isCameraReady, onCapture, onError, resolution.height, resolution.width, documentCorners, isEdgeDetectionActive, isOpenCVReady, processFrame]);\n\n  return (\n    <div \n      ref={containerRef} \n      className={`vision-scanner ${isFullscreen ? 'fullscreen' : ''}`}\n    >\n      {/* Video element - main camera feed */}\n      <video \n        ref={videoRef} \n        autoPlay \n        playsInline \n        muted\n        className=\"vision-scanner-video\" \n      />\n      \n      {/* Hidden canvas for captures */}\n      <canvas \n        ref={canvasRef} \n        className=\"vision-scanner-canvas\" \n        style={{ display: 'none' }} \n      />\n      \n      {/* Edge detection overlay */}\n      <canvas \n        ref={edgeCanvasRef} \n        className=\"vision-scanner-edge-canvas\" \n      />\n      \n      {/* Loading overlay */}\n      {isLoading && (\n        <div className=\"vision-scanner-loading\">\n          <div className=\"loading-spinner\"></div>\n          <div className=\"loading-text\">Initializing camera...</div>\n        </div>\n      )}\n      \n      {/* Document detection guide lines */}\n      {isCameraReady && isOpenCVReady && isEdgeDetectionActive && !documentCorners && (\n        <div className=\"document-guide-overlay\">\n          <div className=\"document-guide-corners\">\n            <div className=\"corner top-left\"></div>\n            <div className=\"corner top-right\"></div>\n            <div className=\"corner bottom-right\"></div>\n            <div className=\"corner bottom-left\"></div>\n          </div>\n          <div className=\"guide-text\">Position document within frame</div>\n        </div>\n      )}\n      \n      {/* UI Controls */}\n      <div className=\"vision-scanner-controls\">\n        {/* iOS-style camera capture button */}\n        <button \n          onClick={capture} \n          className={`vision-scanner-capture-button ${documentCorners ? 'document-ready' : ''}`}\n          disabled={!isCameraReady}\n          aria-label=\"Capture\"\n        >\n          <span className=\"vision-scanner-capture-button-inner\"></span>\n        </button>\n        \n        <div className=\"vision-scanner-secondary-controls\">\n          {cameraCount > 1 && (\n            <button \n              onClick={switchCamera}\n              className=\"vision-scanner-icon-button\"\n              aria-label=\"Switch Camera\"\n            >\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M20 16v4a2 2 0 0 1-2 2h-4\"></path>\n                <path d=\"M14 14l6 6\"></path>\n                <path d=\"M4 8V4a2 2 0 0 1 2-2h4\"></path>\n                <path d=\"M10 10L4 4\"></path>\n              </svg>\n            </button>\n          )}\n          \n          <button \n            onClick={toggleFullscreen}\n            className={`vision-scanner-icon-button ${isFullscreen ? 'active-button' : ''}`}\n            aria-label={isFullscreen ? \"Exit Fullscreen\" : \"Enter Fullscreen\"}\n          >\n            {isFullscreen ? (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M8 3v3a2 2 0 0 1-2 2H3\"></path>\n                <path d=\"M21 8h-3a2 2 0 0 1-2-2V3\"></path>\n                <path d=\"M3 16h3a2 2 0 0 1 2 2v3\"></path>\n                <path d=\"M16 21v-3a2 2 0 0 1 2-2h3\"></path>\n              </svg>\n            ) : (\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M8 3H5a2 2 0 0 0-2 2v3\"></path>\n                <path d=\"M21 8V5a2 2 0 0 0-2-2h-3\"></path>\n                <path d=\"M3 16v3a2 2 0 0 0 2 2h3\"></path>\n                <path d=\"M16 21h3a2 2 0 0 0 2-2v-3\"></path>\n              </svg>\n            )}\n          </button>\n          \n          {hasTorch && (\n            <button \n              onClick={toggleTorch}\n              className={`vision-scanner-icon-button ${torchOn ? 'active-button' : ''}`}\n              aria-label={torchOn ? \"Turn Off Light\" : \"Turn On Light\"}\n            >\n              <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <circle cx=\"12\" cy=\"12\" r=\"5\"></circle>\n                <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"></line>\n                <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"></line>\n                <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"></line>\n                <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"></line>\n                <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"></line>\n                <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"></line>\n                <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\"></line>\n                <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\"></line>\n              </svg>\n            </button>\n          )}\n          \n          <button \n            onClick={toggleEdgeDetection} \n            disabled={!isCameraReady || !isOpenCVReady}\n            className={`vision-scanner-icon-button ${isEdgeDetectionActive ? 'active-button' : ''}`}\n            aria-label={isEdgeDetectionActive ? \"Hide Document Detection\" : \"Show Document Detection\"}\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n              <line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\"></line>\n              <line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\"></line>\n            </svg>\n          </button>\n        </div>\n      </div>\n      \n      {/* Status indicator for OpenCV */}\n      {!isOpenCVReady && isCameraReady && (\n        <div className=\"vision-scanner-status\">\n          <div className=\"status-message\">Loading vision features...</div>\n        </div>\n      )}\n      \n      {/* Document ready indicator */}\n      {documentCorners && (\n        <div className=\"vision-scanner-document-indicator\">\n          <div className=\"document-ready-message\">Document detected</div>\n        </div>\n      )}\n    </div>\n  );\n};"],"names":["_jsxs","_jsx"],"mappings":"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","x_google_ignoreList":[0]}